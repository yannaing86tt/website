{% extends "panel/base.html" %}
{% block title %}Posts{% endblock %}

{% block content %}
<div class="content-header">
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
    <div>
      <h1 class="content-title">Posts</h1>
      <p class="content-subtitle">Manage your blog posts and content</p>
    </div>
    <a href="/panel/posts/new/" class="btn btn-primary">
      â• Create New Post
    </a>
  </div>
</div>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}

<div class="content-body">
  <form method="get" style="margin-bottom: 24px; display:flex; gap:12px; flex-wrap:wrap;">
    <input 
      name="q" 
      placeholder="Search by title..." 
      value="{{ q }}" 
      style="flex: 1; min-width: 250px;"
    >
    <select name="status" style="width: auto;">
      <option value="">All Status</option>
      <option value="draft" {% if status == "draft" %}selected{% endif %}>Draft</option>
      <option value="published" {% if status == "published" %}selected{% endif %}>Published</option>
    </select>
    <button type="submit" class="btn btn-secondary">ğŸ” Filter</button>
    {% if q or status %}
      <a href="/panel/posts/" class="btn btn-secondary">Clear</a>
    {% endif %}
  </form>

  <div style="overflow-x: auto;">
    <table style="width:100%; border-collapse:collapse;">
      <thead>
        <tr style="border-bottom: 2px solid var(--border);">
          <th style="text-align:left; padding:12px 8px; font-size:13px; font-weight:600; color: var(--text-muted);">TITLE</th>
          <th style="text-align:left; padding:12px 8px; font-size:13px; font-weight:600; color: var(--text-muted);">STATUS</th>
          <th style="text-align:left; padding:12px 8px; font-size:13px; font-weight:600; color: var(--text-muted);">AUTHOR</th>
          <th style="text-align:left; padding:12px 8px; font-size:13px; font-weight:600; color: var(--text-muted);">UPDATED</th>
          <th style="text-align:center; padding:12px 8px; font-size:13px; font-weight:600; color: var(--text-muted);">ACTIONS</th>
        </tr>
      </thead>
      <tbody>
        {% for p in posts %}
        <tr style="border-bottom: 1px solid var(--border);">
          <td style="padding:16px 8px;">
            <div style="font-weight:600; margin-bottom: 4px;">{{ p.title }}</div>
            <div style="font-size: 12px; color: var(--text-muted);">{{ p.slug }}</div>
          </td>
          <td style="padding:16px 8px;">
            {% if p.status == 'published' %}
              <span style="background: rgba(16, 185, 129, 0.1); color: var(--success); padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">
                âœ… Published
              </span>
            {% else %}
              <span style="background: rgba(245, 158, 11, 0.1); color: var(--warning); padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">
                ğŸ“‹ Draft
              </span>
            {% endif %}
          </td>
          <td style="padding:16px 8px; color: var(--text-muted); font-size: 14px;">
            {% if p.author %}{{ p.author.username }}{% else %}â€”{% endif %}
          </td>
          <td style="padding:16px 8px; color: var(--text-muted); font-size: 14px;">
            {{ p.updated_at|date:"M d, Y" }}
          </td>
          <td style="padding:16px 8px; text-align:center;">
            <div style="display: flex; gap: 8px; justify-content: center;">
              <a href="/posts/{{ p.slug }}/" target="_blank" class="btn btn-secondary" style="font-size: 12px; padding: 6px 12px;" title="View">
                ğŸ‘ï¸
              </a>
              <a href="/panel/posts/{{ p.id }}/edit/" class="btn btn-secondary" style="font-size: 12px; padding: 6px 12px;">
                Edit
              </a>
              {% if can_delete %}
              <a href="/panel/posts/{{ p.id }}/delete/" class="btn btn-danger" style="font-size: 12px; padding: 6px 12px;">
                Delete
              </a>
              {% endif %}
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" style="padding:32px; text-align:center; color: var(--text-muted);">
            {% if q or status %}
              No posts found matching your filters.
            {% else %}
              No posts yet. Create your first post!
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
